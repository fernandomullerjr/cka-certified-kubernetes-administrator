##############################################################################################################################################################
# ##############################################################################################################################################################
# ##############################################################################################################################################################
# ##############################################################################################################################################################
# push

git status
git add .
git commit -m "Aula 68. Practice Test - Resource Requirements and Limits"
eval $(ssh-agent -s)
ssh-add /home/fernando/.ssh/chave-debian10-github
git push
git status




# ##############################################################################################################################################################
# ##############################################################################################################################################################
# ##############################################################################################################################################################
# ##############################################################################################################################################################
# 68. Practice Test - Resource Requirements and Limits









# A pod called rabbit is deployed. Identify the CPU requirements set on the Pod

in the current(default) namespace


controlplane ~ ➜  

controlplane ~ ➜  kubectl get pods -o yaml
apiVersion: v1
items:
- apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: "2022-12-07T03:20:56Z"
    name: rabbit
    namespace: default
    resourceVersion: "779"
    uid: 50243e5c-c1e0-435d-beff-21f3103b5e82
  spec:
    containers:
    - args:
      - sleep
      - "1000"
      image: ubuntu
      imagePullPolicy: Always
      name: cpu-stress
      resources:
        limits:
          cpu: "2"
        requests:
          cpu: "1"
      terminationMessagePath: /dev/te




# The elephant pod runs a process that consume 15Mi of memory. Increase the limit of the elephant pod to 20Mi.

Delete and recreate the pod if required. Do not modify anything other than the required fields.

    Pod Name: elephant

    Image Name: polinux/stress

    Memory Limit: 20Mi


- Verificado o limit atual do Pod via describe.
- Obtido o manifesto atual, para criar uma nova versão do manifesto:
    8  kubectl describe pod elephant
    9  kubectl get pod elephant -o yaml > pod-editado.yaml


- Criado novo manifesto.
- Deletado o pod antigo que tava crashando.

~~~~yaml
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: "2022-12-07T03:33:09Z"
  name: elephant
  namespace: default
  resourceVersion: "959"
  uid: b536898f-7cb1-4ebb-8dee-0042e355c270
spec:
  containers:
    - args:
        - --vm
        - "1"
        - --vm-bytes
        - 15M
        - --vm-hang
        - "1"
      command:
        - stress
      image: polinux/stress
      imagePullPolicy: Always
      name: mem-stress
      resources:
        limits:
          memory: 20Mi
        requests:
          memory: 5Mi
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rr8n4
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  nodeName: controlplane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rr8n4
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
~~~~


19  cat pod2.yaml 
   20  vi pod2.yaml 
   21  kubectl get pods
   22  kubectl delete pod elephant
   23  kubectl get pods
   24  kubectl apply -f pod2.yaml 
   25  kubectl get pods
   26  kubectl get pods
   27  kubectl describe pod elephant 
   28  history 